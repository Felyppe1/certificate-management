datasource db {
    provider = "postgresql"
    url      = env("DB_URL")
}

generator client {
    provider = "prisma-client-js"
}

model User {
    id            String @id @default(cuid())
    email         String @unique
    name          String
    password_hash String?

    Session             Session[]
    ExternalUserAccount ExternalUserAccount[]

    @@map("users")
}

model Session {
    token   String @id
    user_id String

    User User @relation(fields: [user_id], references: [id])

    @@map("sessions")
}

model ExternalUserAccount {
    user_id          String
    provider         String // "GOOGLE" | "GITHUB" | "FACEBOOK" | ...
    provider_user_id String

    access_token                  String
    refresh_token                 String?
    access_token_expiry_datetime  DateTime?
    refresh_token_expiry_datetime DateTime?

    User User @relation(fields: [user_id], references: [id])

    @@id([user_id, provider])
    @@unique([provider, provider_user_id])
    @@map("external_user_accounts")
}
